import{load,_}from"assets://js/lib/cat.js";let key="童趣",HOST="https://www.boosj.com",siteKey="",siteType=0;const MOBILE_UA="Mozilla/5.0 (Linux; Android 11; M2007J3SC Build/RKQ1.200826.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/77.0.3865.120 MQQBrowser/6.2 TBS/045714 Mobile Safari/537.36";async function request(reqUrl,agentSp){return(await req(reqUrl,{method:"get",headers:{"User-Agent":agentSp||MOBILE_UA,Referer:HOST}})).content}async function init(cfg){siteKey=cfg.skey,siteType=cfg.stype}async function home(filter){const filterObj={},jsonData=[{key:"age",name:"年龄段",value:[{n:"全部",v:""},{n:"6岁以上",v:"?p367=370"},{n:"3~6岁",v:"?p367=369"},{n:"0~3岁",v:"?p367=368"}],init:""},{key:"by",name:"排序",value:[{n:"全部",v:""},{n:"最新发布",v:"lately"},{n:"最多播放",v:"pop"},{n:"最多评论",v:"view"}],init:""}];return JSON.stringify({class:_.map([{type_id:"",type_name:"全部"},{type_id:28,type_name:"辅食"},{type_id:582,type_name:"动画"},{type_id:3364,type_name:"儿童舞蹈"},{type_id:3366,type_name:"少儿英语"},{type_id:3367,type_name:"儿童歌曲"},{type_id:3622,type_name:"才艺"},{type_id:3782,type_name:"播视自制"},{type_id:3822,type_name:"故事"},{type_id:3842,type_name:"亲子教育"},{type_id:4402,type_name:"美术"},{type_id:4583,type_name:"其他"},{type_id:4762,type_name:"儿童游戏"},{type_id:4842,type_name:"识物"},{type_id:4843,type_name:"绘本"},{type_id:4844,type_name:"古诗"},{type_id:4845,type_name:"科普"},{type_id:5102,type_name:"儿童玩具"},{type_id:5142,type_name:"播视童趣儿童玩具"}],cls=>(cls.land=1,cls.ratio=1.78,filterObj[cls.type_id]=jsonData,cls)),filters:filterObj})}async function homeVod(){var html=await request(HOST+"/search_res_3362__3364_1_.html");const $=load(html);html=$("body div.bj-col4:has(h3)"),html=_.map(html,it=>{var a=$(it).find("a:first")[0],img=$(it).find("img:first")[0],it=$(it).find("span.played")[0];return{vod_id:a.attribs.href,vod_name:a.attribs.title,vod_pic:img.attribs["data-original"],vod_remarks:it.children[0].data||""}});return JSON.stringify({list:html})}async function category(tid,pg,filter,extend){(pg<=0||void 0===pg)&&(pg=1);tid=await request(HOST+"/search_res_3362__"+tid+"_"+pg+"_"+(extend.by||"")+".html"+(extend.age||""));const $=load(tid);extend=$("body div.bj-col4:has(h3)"),tid=_.map(extend,it=>{var a=$(it).find("a:first")[0],img=$(it).find("img:first")[0],it=$(it).find("span.played")[0];return{vod_id:a.attribs.href,vod_name:a.attribs.title,vod_pic:img.attribs["data-original"],vod_remarks:it.children[0].data||""}}),extend=0<$("div.pub_paging > a:contains(下一页)").length?parseInt(pg)+1:parseInt(pg);return JSON.stringify({page:parseInt(pg),pagecount:extend,limit:30,total:30*extend,list:tid})}async function detail(id){var id={vod_id:id,vod_remarks:""},playlist=["点击播放$"+id.vod_id];return id.vod_play_from="道长在线",id.vod_play_url=playlist.join("#"),JSON.stringify({list:[id]})}async function play(flag,id,flags){var body=JSON.parse(await request("https://gslb.boosj.com/ipv2.json")),id=(body._id=id.match(/\d+/)[0],JSON.parse(await request(buildUrl(body.gslb,body)))),body=id.url+"?"+id.t;return JSON.stringify({parse:0,url:body,header:{"User-Agent":"Dalvik/2.1.0 (Linux; U; Android 9; 22081212C Build/PQ3B.190801.002)"}})}async function search(wd,quick){var wd=JSON.parse(await request("https://search.boosj.com/m_ajax?q="+wd+"&p="+pg+"&typeId=3362")).body,videos=_.map(wd.result,it=>({vod_id:it.playUrl,vod_name:it.resourceName,vod_pic:it.imageUrl,vod_remarks:it.clickNumStr||""}));return JSON.stringify({page:parseInt(pg),pagecount:wd.pageCount,limit:30,total:wd.rowCount,list:videos})}function buildUrl(url,obj){obj=obj||{},url.indexOf("?")<0&&(url+="?");let param_list=[];var keys=Object.keys(obj),prs=(keys.forEach(it=>{param_list.push(it+"="+obj[it])}),param_list.join("&"));return 0<keys.length&&!url.endsWith("?")&&(url+="&"),url+=prs}function __jsEvalReturn(){return{init:init,home:home,homeVod:homeVod,category:category,detail:detail,play:play,search:search}}export{__jsEvalReturn};