const _0x475d0a=_0x1960;function _0x1960(_0x3b3566,_0x2e9adf){const _0x4fdc09=_0x2ae1();return(_0x1960=function(_0x3a65fa,_0x389bb7){return _0x3a65fa-=203,_0x4fdc09[_0x3a65fa]})(_0x3b3566,_0x2e9adf)}!function(){for(var _0x54b68f=_0x1960,_0x24ba8c=_0x2ae1();;)try{if(613464==+parseInt(_0x54b68f(221))+-parseInt(_0x54b68f(333))/2+-parseInt(_0x54b68f(320))/3+parseInt(_0x54b68f(339))/4*(parseInt(_0x54b68f(277))/5)+-parseInt(_0x54b68f(242))/6*(-parseInt(_0x54b68f(269))/7)+parseInt(_0x54b68f(383))/8+-parseInt(_0x54b68f(390))/9*(parseInt(_0x54b68f(338))/10))break;_0x24ba8c.push(_0x24ba8c.shift())}catch(_0x3fb5b5){_0x24ba8c.push(_0x24ba8c.shift())}}();const _0x389bb7=function(){let _0x1a7634=!0;return function(_0x5b6f22,_0x4aa7a8){var _0x30095d=_0x1a7634?function(){var _0x28af2f;if(_0x4aa7a8)return _0x28af2f=_0x4aa7a8[_0x1960(212)](_0x5b6f22,arguments),_0x4aa7a8=null,_0x28af2f}:function(){};return _0x1a7634=!1,_0x30095d}}(),_0x3a65fa=_0x389bb7(this,function(){var _0x43683a=_0x1960,_0x26fa0b=function(){var _0x112fa4=_0x1960;let _0x285433;try{_0x285433=Function(_0x112fa4(366)+'{}.constructor("return this")( ));')()}catch(_0x5b0321){_0x285433=window}return _0x285433}(),_0x1de15d=_0x26fa0b[_0x43683a(222)]=_0x26fa0b[_0x43683a(222)]||{},_0x58df9d=[_0x43683a(295),"warn",_0x43683a(211),_0x43683a(376),_0x43683a(344),"table",_0x43683a(332)];for(let _0x460471=0;_0x460471<_0x58df9d[_0x43683a(316)];_0x460471++){var _0x21102a=_0x389bb7[_0x43683a(317)][_0x43683a(299)][_0x43683a(245)](_0x389bb7),_0x3ab8f5=_0x58df9d[_0x460471],_0x1c5cad=_0x1de15d[_0x3ab8f5]||_0x21102a;_0x21102a[_0x43683a(352)]=_0x389bb7[_0x43683a(245)](_0x389bb7),_0x21102a[_0x43683a(370)]=_0x1c5cad[_0x43683a(370)][_0x43683a(245)](_0x1c5cad),_0x1de15d[_0x3ab8f5]=_0x21102a}});_0x3a65fa();import{_,jinja2}from"assets://js/lib/cat.js";import*as _0x5f2ae7 from"./utils.js";class User{constructor(){var _0x10e3ff=_0x1960;this[_0x10e3ff(362)]="",this[_0x10e3ff(256)]="",this.tokenType="",this[_0x10e3ff(305)]="",this[_0x10e3ff(238)]=""}static["objectFrom"](_0x168463){var _0x4764ce,_0x59ea84=_0x1960;return _[_0x59ea84(391)](_0x168463)?new User:(_0x168463=JSON.parse(_0x168463),(_0x4764ce=new User)[_0x59ea84(362)]=_0x168463.default_drive_id,_0x4764ce.userId=_0x168463.user_id,_0x4764ce.tokenType=_0x168463.token_type,_0x4764ce[_0x59ea84(305)]=_0x168463[_0x59ea84(253)],_0x4764ce[_0x59ea84(238)]=_0x168463.refresh_token,_0x4764ce)}[_0x475d0a(384)](){var _0x3fecce=_0x475d0a;return _[_0x3fecce(391)](this[_0x3fecce(362)])?"":this[_0x3fecce(362)]}["getUserId"](){var _0x507a53=_0x475d0a;return _[_0x507a53(391)](this[_0x507a53(256)])?"":this[_0x507a53(256)]}[_0x475d0a(247)](){var _0x363170=_0x475d0a;return _[_0x363170(391)](this[_0x363170(347)])?"":this[_0x363170(347)]}[_0x475d0a(208)](){var _0x460056=_0x475d0a;return _[_0x460056(391)](this.accessToken)?"":this[_0x460056(305)]}["getRefreshToken"](){var _0x454d4f=_0x475d0a;return _[_0x454d4f(391)](this[_0x454d4f(238)])?"":this[_0x454d4f(238)]}[_0x475d0a(368)](_0x47f5b0){this.refreshToken=_0x47f5b0}[_0x475d0a(258)](){var _0x5b2741=_0x475d0a;return this.getTokenType()+" "+this[_0x5b2741(208)]()}["isAuthed"](){var _0x47d844=_0x475d0a;return 0<this.getTokenType()[_0x47d844(316)]&&0<this[_0x47d844(208)]().length}[_0x475d0a(319)](){var _0x3df0d2=_0x475d0a;return this[_0x3df0d2(238)]="",this[_0x3df0d2(305)]="",this}async[_0x475d0a(279)](){var _0x308ba6=_0x475d0a;return await local[_0x308ba6(342)](_0x308ba6(354),_0x308ba6(301),this[_0x308ba6(370)]()),this}[_0x475d0a(370)](){var _0x409a17=_0x475d0a,_0x23e797={default_drive_id:this[_0x409a17(384)](),user_id:this[_0x409a17(300)](),token_type:this[_0x409a17(247)](),access_token:this[_0x409a17(208)](),refresh_token:this[_0x409a17(274)]()};return JSON[_0x409a17(251)](_0x23e797)}}class OAuth{constructor(){var _0x5bbff3=_0x475d0a;this[_0x5bbff3(347)]="",this[_0x5bbff3(305)]="",this.refreshToken=""}static[_0x475d0a(207)](_0x31d5ae){var _0x4d660e,_0x40ac24=_0x475d0a;return console[_0x40ac24(295)]("OAuthobjectFrom----- "),console.log(_0x31d5ae),_.isEmpty(_0x31d5ae)?new OAuth:(_0x31d5ae=JSON[_0x40ac24(302)](_0x31d5ae),(_0x4d660e=new OAuth)[_0x40ac24(347)]=_0x31d5ae[_0x40ac24(303)],_0x4d660e.accessToken=_0x31d5ae.access_token,_0x4d660e[_0x40ac24(238)]=_0x31d5ae[_0x40ac24(323)],_0x4d660e)}[_0x475d0a(247)](){var _0x5d51a7=_0x475d0a;return _[_0x5d51a7(391)](this.tokenType)?"":this.tokenType}[_0x475d0a(208)](){var _0x12f670=_0x475d0a;return _.isEmpty(this.accessToken)?"":this[_0x12f670(305)]}[_0x475d0a(274)](){var _0x1acf0=_0x475d0a;return _.isEmpty(this[_0x1acf0(238)])?"":this.refreshToken}[_0x475d0a(258)](){var _0x5d166e=_0x475d0a;return this[_0x5d166e(247)]()+" "+this[_0x5d166e(208)]()}[_0x475d0a(319)](){var _0x55890b=_0x475d0a;return this[_0x55890b(238)]="",this[_0x55890b(305)]="",this}async[_0x475d0a(279)](){var _0x20ac2e=_0x475d0a;return await local.set("ali",_0x20ac2e(294),this[_0x20ac2e(370)]()),this}["toString"](){var _0x3b3f46=_0x475d0a,_0x3b3f46={token_type:this[_0x3b3f46(247)](),access_token:this[_0x3b3f46(208)](),refresh_token:this[_0x3b3f46(274)]()};return JSON.stringify(_0x3b3f46)}}class Code{constructor(){this[_0x475d0a(246)]=""}static[_0x475d0a(207)](_0x3b40c3){var _0x3afc06,_0xd9f7e0=_0x475d0a;return _[_0xd9f7e0(391)](_0x3b40c3)?new Code:(_0x3b40c3=JSON.parse(_0x3b40c3),(_0x3afc06=new Code)[_0xd9f7e0(246)]=_0x3b40c3[_0xd9f7e0(246)],_0x3afc06)}[_0x475d0a(216)](){var _0x4bf1bd=_0x475d0a;return _.isEmpty(this[_0x4bf1bd(246)])?"":this.redirectUri}["getCode"](){var _0x48a452=_0x475d0a;return this[_0x48a452(216)]()[_0x48a452(276)]("code=")[1]}}class Item{constructor(_0x55ee5a){var _0x2418c3=_0x475d0a;this[_0x2418c3(310)]=[],this.nextMarker="",this[_0x2418c3(244)]=_0x55ee5a,this[_0x2418c3(325)]="",this.name="",this[_0x2418c3(271)]="",this[_0x2418c3(226)]="",this[_0x2418c3(235)]="",this[_0x2418c3(372)]="",this[_0x2418c3(290)]=""}static[_0x475d0a(207)](_0x4174d7){const _0x22ffc9=_0x475d0a;if(_.isEmpty(_0x4174d7))return new Item;let _0x4ca777=JSON[_0x22ffc9(302)](_0x4174d7),_0x6ae688=new Item;return _0x6ae688[_0x22ffc9(340)]=typeof _0x4ca777[_0x22ffc9(291)]==_0x22ffc9(252)?"":_0x4ca777[_0x22ffc9(291)],_0x6ae688.fileId=void 0===_0x4ca777.file_id?"":_0x4ca777[_0x22ffc9(225)],_0x6ae688[_0x22ffc9(325)]=void 0===_0x4ca777[_0x22ffc9(266)]?"":_0x4ca777[_0x22ffc9(266)],_0x6ae688[_0x22ffc9(231)]=typeof _0x4ca777[_0x22ffc9(231)]==_0x22ffc9(252)?"":_0x4ca777[_0x22ffc9(231)],_0x6ae688[_0x22ffc9(271)]=typeof _0x4ca777[_0x22ffc9(271)]==_0x22ffc9(252)?"":_0x4ca777[_0x22ffc9(271)],_0x6ae688.fileExtension=void 0===_0x4ca777[_0x22ffc9(273)]?"":_0x4ca777[_0x22ffc9(273)],_0x6ae688[_0x22ffc9(235)]=void 0===_0x4ca777[_0x22ffc9(235)]?"":_0x4ca777[_0x22ffc9(235)],_0x6ae688[_0x22ffc9(372)]=typeof _0x4ca777[_0x22ffc9(372)]==_0x22ffc9(252)?"":_0x4ca777.size,_0x6ae688[_0x22ffc9(290)]=void 0===_0x4ca777[_0x22ffc9(220)]?"":_0x4ca777[_0x22ffc9(220)],typeof _0x4ca777[_0x22ffc9(310)]!=_0x22ffc9(252)&&Array[_0x22ffc9(282)](_0x4ca777[_0x22ffc9(310)])&&!_[_0x22ffc9(391)](_0x4ca777.items)&&_0x4ca777[_0x22ffc9(310)].forEach(function(_0x52899a){var _0x30db9a=_0x22ffc9,_0x52899a=Item[_0x30db9a(207)](JSON[_0x30db9a(251)](_0x52899a));_0x6ae688[_0x30db9a(310)].push(_0x52899a)}),_0x6ae688}[_0x475d0a(361)](){var _0x4c67cd=_0x475d0a;return _[_0x4c67cd(391)](this[_0x4c67cd(310)])?[]:this.items}[_0x475d0a(281)](){var _0x5e947b=_0x475d0a;return _.isEmpty(this[_0x5e947b(340)])?"":this[_0x5e947b(340)]}[_0x475d0a(232)](){var _0x5082db=_0x475d0a;return _[_0x5082db(391)](this[_0x5082db(244)])?"":this[_0x5082db(244)]}["getName"](){var _0x467f0c=_0x475d0a;return _[_0x467f0c(391)](this.name)?"":this[_0x467f0c(231)]}[_0x475d0a(292)](){var _0x120969=_0x475d0a;return _[_0x120969(391)](this[_0x120969(271)])?"":this[_0x120969(271)]}[_0x475d0a(275)](){var _0x2e8b65=_0x475d0a;return _[_0x2e8b65(391)](this[_0x2e8b65(226)])?"":this[_0x2e8b65(226)]}[_0x475d0a(389)](){var _0x543df9=_0x475d0a;return _[_0x543df9(391)](this[_0x543df9(235)])?"":this[_0x543df9(235)]}[_0x475d0a(288)](){return 0==this.size?"":"["+_0x5f2ae7.getSize(this.size)+"]"}[_0x475d0a(374)](){var _0x5956e3=_0x475d0a;return _[_0x5956e3(391)](this.parent)?"":"["+this[_0x5956e3(290)]+"]"}["parentFunc"](_0x2bc127){return this[_0x475d0a(290)]=_0x2bc127,this}[_0x475d0a(297)](){var _0x153ffe=_0x475d0a;return this[_0x153ffe(374)]()+" "+this[_0x153ffe(237)]()+" "+this.getSize()}}class Sub{constructor(){var _0x27438d=_0x475d0a;this[_0x27438d(318)]="",this[_0x27438d(231)]="",this.lang="",this.format=""}static[_0x475d0a(205)](){return new Sub}[_0x475d0a(387)](_0xddda04){return this[_0x475d0a(231)]=_0xddda04,this}["setUrl"](_0x28433b){return this[_0x475d0a(318)]=_0x28433b,this}["setLang"](_0x403e9a){return this.lang=_0x403e9a,this}["setFormat"](_0x510b5b){return this[_0x475d0a(214)]=_0x510b5b,this}[_0x475d0a(210)](_0x1c1623){var _0x3bb80d=_0x475d0a;switch(_0x1c1623){case _0x3bb80d(204):return this[_0x3bb80d(375)]("text/vtt");case"ass":case"ssa":return this[_0x3bb80d(375)]("text/x-ssa");default:return this[_0x3bb80d(375)](_0x3bb80d(313))}}}const UA=_0x475d0a(345),CLIENT_ID=_0x475d0a(218);let quality={},tempIds=[],refreshToken="",shareToken="",shareId="",oauth=new OAuth,user=new User,driveInfo={},tmpFolderName="tmp_for_resource",curTmpFolderFileId="",log=_0x5f2ae7.log;async function getUserCache(){var _0x3172e7=_0x475d0a;return await local[_0x3172e7(369)]("ali",_0x3172e7(301))}async function getOAuthCache(){var _0x10b9a0=_0x475d0a;return await local[_0x10b9a0(369)]("ali","aliyundrive_oauth")}async function initSome(){var _0x51bdb3=_0x475d0a,_0x4ab022=(tempIds=[],await getOAuthCache()),_0x4ab022=(await log(_0x51bdb3(284)+_0x4ab022),oauth=OAuth.objectFrom(_0x4ab022),console[_0x51bdb3(314)](_0x51bdb3(249)),console[_0x51bdb3(314)](oauth),await getUserCache());console[_0x51bdb3(314)](_0x4ab022),await log(_0x51bdb3(386)+_0x4ab022),user=User[_0x51bdb3(207)](_0x4ab022),quality={"4K":_0x51bdb3(304),"2k":_0x51bdb3(260),"超清":_0x51bdb3(234),"高清":"HD","标清":"SD","流畅":"LD"}}function setRefreshToken(_0x3ca000){refreshToken=_0x3ca000}function getToken(){var _0x2976e5=_0x475d0a;return user[_0x2976e5(274)]()}async function setShareId(_0x2d393c){var _0x5e37da=_0x475d0a;0==getOAuthCache()[_0x5e37da(316)]&&await oauth.clean()[_0x5e37da(279)](),0==getUserCache()[_0x5e37da(316)]&&await user[_0x5e37da(319)]()[_0x5e37da(279)](),shareId=_0x2d393c,await refreshShareToken()}function getHeader(){var _0x14cec3=_0x475d0a,_0x1caa15={};return _0x1caa15[_0x14cec3(206)]=UA,_0x1caa15[_0x14cec3(367)]=_0x14cec3(350),_0x1caa15}function getHeaderAuth(){var _0x2e59ce=_0x475d0a,_0x495cd9={};return _0x495cd9["x-share-token"]=shareToken,_0x495cd9["X-Canary"]=_0x2e59ce(239),user[_0x2e59ce(213)]()&&(_0x495cd9.authorization=user.getAuthorization()),_0x495cd9}function getHeaderShare(){var _0x4d9780=_0x475d0a,_0x4da1d6=getHeader();return _0x4da1d6[_0x4d9780(261)]=shareToken,_0x4da1d6["X-Canary"]=_0x4d9780(239),_0x4da1d6}function getHeaderOpen(){var _0x4acb6a=_0x475d0a,_0x4cbfa4={};return console.debug(_0x4acb6a(326)),console[_0x4acb6a(314)](oauth),_0x4cbfa4[_0x4acb6a(287)]=oauth[_0x4acb6a(258)](),_0x4cbfa4}async function alist(_0xd7cae8,_0x1c8f86){var _0x20b6b8=_0x475d0a,_0x1c8f86=(await postJson(_0x20b6b8(336)+_0xd7cae8,_0x1c8f86,getHeader()))[_0x20b6b8(265)];return console[_0x20b6b8(314)](_0x20b6b8(371)+_0xd7cae8),console[_0x20b6b8(314)](_0x1c8f86),!await isManyRequest(_0x1c8f86)&&(oauth=await OAuth.objectFrom(_0x1c8f86).save(),!0)}async function getString(_0x3f0365){var _0x83af22=_0x475d0a;return(await req(_0x3f0365,{}))[_0x83af22(265)]}async function postJson(_0x53da97,_0x1cb102,_0x106c3d){var _0x56505c=_0x475d0a,_0x53da97=(_0x106c3d[_0x56505c(322)]=_0x56505c(359),await req(_0x53da97,{headers:_0x106c3d,method:_0x56505c(230),data:_0x1cb102}));return _0x53da97}async function post(_0x1a5b50,_0x1bd558){var _0x2342e6=_0x475d0a;return(await postJson(_0x1a5b50=_0x1a5b50[_0x2342e6(227)](_0x2342e6(259))?_0x1a5b50:_0x2342e6(298)+_0x1a5b50,_0x1bd558,getHeader()))[_0x2342e6(265)]}async function auth(_0x2e711e,_0x539d0d,_0x450932){var _0x4d132c=_0x475d0a,_0x47047a=await postJson(_0x2e711e=_0x2e711e[_0x4d132c(227)]("https")?_0x2e711e:_0x4d132c(298)+_0x2e711e,_0x539d0d,getHeaderAuth());return await log(_0x4d132c(351)+_0x47047a.content),_0x450932&&(400==_0x47047a[_0x4d132c(209)]||401==_0x47047a[_0x4d132c(209)])&&await refreshAccessToken()?(await log("auth--res--400"+_0x47047a[_0x4d132c(265)]),auth(_0x2e711e,_0x539d0d,!1)):_0x450932&&429==_0x47047a.code?(await log(_0x4d132c(229)+_0x47047a.content),auth(_0x2e711e,_0x539d0d,!1)):_0x47047a.content}async function shareFunc(_0x33bb85,_0x20c4e6){var _0x51d581=_0x475d0a,_0x18cc9a=(_0x33bb85=_0x33bb85[_0x51d581(227)]("https")?_0x33bb85:"https://api.aliyundrive.com/"+_0x33bb85,getHeaderShare()),_0x590866=await postJson(_0x33bb85,_0x20c4e6,_0x18cc9a);return console[_0x51d581(314)](_0x51d581(315)+_0x33bb85),console[_0x51d581(314)](_0x18cc9a),console[_0x51d581(314)](_0x20c4e6),console.debug(_0x590866),_0x590866[_0x51d581(265)]}async function oauthFunc(_0xc6dd7f,_0x136b31,_0x3c591c){var _0x3cfe09=_0x475d0a,_0x3f751a=await postJson(_0xc6dd7f=_0xc6dd7f[_0x3cfe09(227)](_0x3cfe09(259))?_0xc6dd7f:_0x3cfe09(286)+_0xc6dd7f,_0x136b31,getHeaderOpen());return await log("oauthFunc--res-1-"+_0xc6dd7f),await log("oauthFunc--res-1-"+JSON[_0x3cfe09(251)](_0x3f751a)),_0x3c591c&&(400==_0x3f751a[_0x3cfe09(209)]||401==_0x3f751a.code)&&await refreshOpenToken()?(await log(_0x3cfe09(241)+_0x3f751a[_0x3cfe09(265)]),oauthFunc(_0xc6dd7f,_0x136b31,!1)):_0x3f751a[_0x3cfe09(265)]}async function isManyRequest(_0x566244){var _0x4cbd29=_0x475d0a;return-1<_0x566244[_0x4cbd29(358)]("Too Many Requests")&&(await oauth.clean()[_0x4cbd29(279)](),!0)}async function refreshShareToken(){var _0x2850fe=_0x475d0a;try{var _0x1b9661={},_0x57ec20=(_0x1b9661[_0x2850fe(266)]=shareId,_0x1b9661[_0x2850fe(393)]="",await post("v2/share_link/get_share_token",_0x1b9661)),_0x383e26=JSON[_0x2850fe(302)](_0x57ec20);shareToken=_0x383e26.share_token}catch(_0x458cf4){console[_0x2850fe(314)](_0x458cf4)}}async function refreshAccessToken(){var _0x2761b5=_0x475d0a;try{let _0x3eb65f={},_0x1b9846=user[_0x2761b5(274)]();(_0x1b9846=_[_0x2761b5(391)](_0x1b9846)?refreshToken:_0x1b9846)[_0x2761b5(227)]("http")&&(_0x1b9846=(_0x1b9846=await getString(_0x1b9846)).trim()),_0x3eb65f.refresh_token=_0x1b9846,_0x3eb65f.grant_type=_0x2761b5(323),await log(_0x2761b5(329)+JSON.stringify(_0x3eb65f));var _0x6463=await post(_0x2761b5(378),_0x3eb65f);if(await log(_0x2761b5(328)+_0x6463),user=await User[_0x2761b5(207)](_0x6463)[_0x2761b5(279)](),await log(_0x2761b5(343)+user.getDriveId()),_.isEmpty(user.getAccessToken()))throw new Error(_0x6463);return!0}catch(_0x1a6f2d){return await log("refreshAccessToken---error-"+_0x1a6f2d[_0x2761b5(228)]),console[_0x2761b5(314)](_0x1a6f2d),await user.clean()[_0x2761b5(279)](),!0}}function _0x2ae1(){const _0x216394=["share_id","-----createTmpFolder-----","folder","14609vDTFfP","join","type","default_drive_id","file_extension","getRefreshToken","getExt","split","815ZkhJaU","getVideoPreviewPlayInfo===","save","parentFunc","getNextMarker","isArray","unshift","initSome----oauth-","user:base,file:all:read,file:all:write","https://open.aliyundrive.com/adrive/v1.0/","authorization","getSize","adrive/v2/batch","parent","next_marker","getType","阿里云盘","aliyundrive_oauth","log","https://open.aliyundrive.com/oauth/users/authorize?client_id=","getDisplayName","https://api.aliyundrive.com/","prototype","getUserId","aliyundrive_user","parse","token_type","UHD","accessToken","token","video","ASC","adrive/v2/file/list_by_share","items","push","backup_drive_id","application/x-subrip","debug","----shareFunc----","length","constructor","url","clean","2461506OgBhNE","copy---user-","Content-Type","refresh_token","hasOwnProperty","shareId","getHeaderOpen---","v2/batch","refreshAccessToken---result--","refreshAccessToken---body--","drive_id","curDriveInfo---","trace","99882ClAEVN","trashFile-----","application/x-mpegURL","https://api-cf.nn.ci/alist/ali_open/","resource_drive_id","121720JEKXvw","21324xXWquH","nextMarker","getDownloadUrl--fileId-","set","refreshAccessToken--user.driveId-","exception","Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1","avatar","tokenType","oauthRequest---","order_by","https://www.aliyundrive.com/","auth--res--","__proto__","getDownloadUrl---","ali","copy---result","application/octet-stream","live_transcoding_task_list","indexOf","application/json","ForbiddenNoPermission.File","getItems","driveId","toLowerCase","video_preview_play_info","openFile/getVideoPreviewPlayInfo","return (function() ","Referer","setRefreshToken","get","toString","alist---","size","@@@","getParent","setFormat","error","user/getDriveInfo","https://auth.aliyundrive.com/v2/account/token","language","isSub","openFile/getDownloadUrl","marker","2595072ZXULGt","getDriveId","root","initSome----user-","setName","-----tmpFolderFileId-----","getCategory","612ublqqZ","isEmpty",'{"requests":[{"body":{"file_id":"{{data.fileId}}","drive_id":"{{data.driveId}}"},"headers":{"Content-Type":"application/json"},"id":"0","method":"POST","url":"/recyclebin/trash"}],"resource":"file"}',"share_pwd","limit","vtt","create","User-Agent","objectFrom","getAccessToken","code","setExt","info","apply","isAuthed","format","live_transcoding_subtitle_task_list","getRedirectUri","14400","76917ccccd4441c39457a04f6084fb2f","body","parent_file_id","446252NbMsqD","console","adrive/v3/share_link/get_share_by_anonymous","recyclebinClear-----","file_id","fileExtension","startsWith","message","auth--res--429","post","name","getFileId","grant_type","FHD","category","removeExt","getName","refreshToken","client=Android,app=adrive,version=v4.3.1","------tmpFolderExists-------","oauthFunc--res-2-","1932xiudfA","template_id","fileId","bind","redirectUri","getTokenType","responses","initSome----","copy---","stringify","undefined","access_token",'{"requests":[{"body":{"file_id":"{{data.fileId}}","share_id":"{{data.shareId}}","auto_rename":true,"to_parent_file_id":"{{data.tmpFolderFileId}}","to_drive_id":"{{data.driveId}}"},"headers":{"Content-Type":"application/json"},"id":"0","method":"POST","url":"/file/copy"}],"resource":"file"}',"setUrl","userId","live_transcoding","getAuthorization","https","QHD","x-share-token","openFile/create","authorization_code","authorize","content"];return(_0x2ae1=function(){return _0x216394})()}async function oauthRequest(){var _0x297408=_0x475d0a;try{var _0x2e1971={},_0x4ba4d3=(_0x2e1971[_0x297408(264)]=1,_0x2e1971.scope=_0x297408(285),_0x297408(296)+CLIENT_ID+"&redirect_uri=https://alist.nn.ci/tool/aliyundrive/callback&scope=user:base,file:all:read,file:all:write&state="),_0x23a922=await auth(_0x4ba4d3,_0x2e1971,!0);return await log(_0x297408(348)+_0x23a922),console.debug(_0x297408(348)),console.debug(_0x23a922),await oauthRedirect(Code[_0x297408(207)](_0x23a922).getCode())}catch(_0x20a5ac){return console[_0x297408(314)](_0x20a5ac),!1}}async function oauthRedirect(_0x464a61){var _0x1c5877=_0x475d0a;try{var _0x4d9e11={};return _0x4d9e11[_0x1c5877(209)]=_0x464a61,_0x4d9e11[_0x1c5877(233)]=_0x1c5877(263),await alist(_0x1c5877(209),_0x4d9e11)}catch(_0x114c46){return console[_0x1c5877(314)](_0x114c46),await oauth[_0x1c5877(319)]()[_0x1c5877(279)](),!1}}async function refreshOpenToken(){var _0x2a7205,_0x3cd037=_0x475d0a;try{return _[_0x3cd037(391)](oauth.getRefreshToken())?await oauthRequest():((_0x2a7205={})[_0x3cd037(233)]=_0x3cd037(323),_0x2a7205.refresh_token=oauth[_0x3cd037(274)](),await alist(_0x3cd037(306),_0x2a7205))}catch(_0x3d6bf0){return console[_0x3cd037(314)](_0x3d6bf0),oauth[_0x3cd037(319)]()[_0x3cd037(279)](),!1}}async function getVod(_0x44edf2,_0x3a1577){var _0x2e60ee,_0x5b9f62=_0x475d0a,_0x159c79={},_0x159c79=(_0x159c79[_0x5b9f62(266)]=shareId,await post(_0x5b9f62(223),_0x159c79)),_0x159c79=JSON[_0x5b9f62(302)](_0x159c79),_0x2a8932=[],_0x185d3e=[],_0x3a1577=getParentFileId(_0x3a1577,_0x159c79),_0x51f891=(await listFiles(new Item(_0x3a1577),_0x2a8932,_0x185d3e),["原画","超清","高清"]),_0x3048b2=[],_0x4529ae=[];for(_0x2e60ee of _0x2a8932)_0x3048b2[_0x5b9f62(311)](_0x2e60ee[_0x5b9f62(297)]()+"$"+_0x2e60ee[_0x5b9f62(232)]()+findSubs(_0x2e60ee[_0x5b9f62(237)](),_0x185d3e));for(var _0x30df75=0;_0x30df75<_0x51f891[_0x5b9f62(316)];_0x30df75++)_0x4529ae[_0x5b9f62(311)](_0x3048b2.join("#"));return{vod_id:_0x44edf2,vod_content:_0x44edf2,vod_pic:_0x159c79[_0x5b9f62(346)],vod_name:_0x159c79.share_name,vod_play_url:_0x4529ae[_0x5b9f62(270)]("$$$"),vod_play_from:_0x51f891[_0x5b9f62(270)]("$$$"),type_name:_0x5b9f62(293),vod_year:"",vod_area:"",vod_remarks:"",vod_actor:"",vod_director:""}}async function listFiles(_0x44c747,_0x3fe101,_0x4662ce){return listFilesMarker(_0x44c747,_0x3fe101,_0x4662ce,"")}async function listFilesMarker(_0x12b384,_0x23dcbe,_0x2b629f,_0x17d2f3){var _0x4b8202,_0x41704d,_0xf2d865=_0x475d0a,_0x17a017={},_0x58f77e=[],_0x17d2f3=(_0x17a017[_0xf2d865(203)]=200,_0x17a017[_0xf2d865(266)]=shareId,_0x17a017[_0xf2d865(220)]=_0x12b384[_0xf2d865(232)](),_0x17a017[_0xf2d865(349)]=_0xf2d865(231),_0x17a017.order_direction=_0xf2d865(308),0<_0x17d2f3[_0xf2d865(316)]&&(_0x17a017[_0xf2d865(382)]=_0x17d2f3),Item[_0xf2d865(207)](await shareFunc(_0xf2d865(309),_0x17a017)));for(_0x4b8202 of _0x17d2f3[_0xf2d865(361)]())_0x4b8202[_0xf2d865(292)]()==_0xf2d865(268)?_0x58f77e[_0xf2d865(311)](_0x4b8202):"video"==_0x4b8202.getCategory()||"audio"==_0x4b8202[_0xf2d865(389)]()?_0x23dcbe[_0xf2d865(311)](_0x4b8202[_0xf2d865(280)](_0x12b384[_0xf2d865(237)]())):_0x5f2ae7[_0xf2d865(380)](_0x4b8202[_0xf2d865(275)]())&&_0x2b629f[_0xf2d865(311)](_0x4b8202);0<_0x17d2f3[_0xf2d865(281)]().length&&await listFilesMarker(_0x12b384,_0x23dcbe,_0x2b629f,_0x17d2f3[_0xf2d865(281)]());for(_0x41704d of _0x58f77e)await listFiles(_0x41704d,_0x23dcbe,_0x2b629f)}function getParentFileId(_0x51a121,_0x254338){var _0x1b764d=_0x475d0a,_0x254338=_0x254338.file_infos;return _[_0x1b764d(391)](_0x51a121)?0==_0x254338[_0x1b764d(316)]?"":"folder"==(_0x254338=_0x254338[0])[_0x1b764d(271)]?_0x254338.file_id:"file"==_0x254338.type&&_0x254338[_0x1b764d(235)]==_0x1b764d(307)?"root":"":_0x51a121}function pair(_0x5d750b,_0x4de629,_0x271dd1){var _0x3ff9a0,_0x1d5310=_0x475d0a;for(_0x3ff9a0 of _0x4de629){var _0x1f881c=_0x5f2ae7[_0x1d5310(236)](_0x3ff9a0[_0x1d5310(237)]())[_0x1d5310(363)]();(-1<_0x5d750b[_0x1d5310(358)](_0x1f881c)||-1<_0x1f881c[_0x1d5310(358)](_0x5d750b))&&_0x271dd1.push(_0x3ff9a0)}}function findSubs(_0x3ede19,_0x4a8833){var _0x2f7dbb,_0x2c5c94=_0x475d0a,_0x423c93=[];if(pair(_0x5f2ae7[_0x2c5c94(236)](_0x3ede19).toLowerCase(),_0x4a8833,_0x423c93),0==_0x423c93[_0x2c5c94(316)])for(var _0x4afa94 of _0x4a8833)_0x423c93[_0x2c5c94(311)](_0x4afa94);let _0x4c164b="";for(_0x2f7dbb of _0x423c93)_0x4c164b+="+"+_0x5f2ae7[_0x2c5c94(236)](_0x2f7dbb[_0x2c5c94(237)]())+_0x2c5c94(373)+_0x2f7dbb[_0x2c5c94(275)]()+_0x2c5c94(373)+_0x2f7dbb[_0x2c5c94(232)]();return _0x4c164b}async function getSubs(_0x28986a){var _0x5a6e4f,_0x50c7db,_0x2fa639,_0x482f1f,_0xf7429c=_0x475d0a,_0x2e50d2=[];for(_0x5a6e4f of _0x28986a)-1<_0x5a6e4f[_0xf7429c(358)](_0xf7429c(373))&&(_0x50c7db=(_0x482f1f=_0x5a6e4f[_0xf7429c(276)](_0xf7429c(373)))[0],_0x2fa639=_0x482f1f[1],_0x482f1f=await getDownloadUrl(_0x482f1f[2]),_0x2e50d2.push(Sub[_0xf7429c(205)]()[_0xf7429c(387)](_0x50c7db).setExt(_0x2fa639).setUrl(_0x482f1f)));return _0x2e50d2}async function getDriveInfo(){var _0x3740f3,_0x5d01df=_0x475d0a;return(_[_0x5d01df(391)](driveInfo)||_[_0x5d01df(391)](driveInfo[_0x5d01df(272)]))&&(_0x3740f3=await oauthFunc(_0x5d01df(377),{},!0),_0x3740f3=JSON[_0x5d01df(302)](_0x3740f3),driveInfo={default_drive_id:_0x3740f3.default_drive_id,resource_drive_id:_0x3740f3[_0x5d01df(337)],backup_drive_id:_0x3740f3[_0x5d01df(312)]}),driveInfo}async function getDriveId(){var _0x1768d7=_0x475d0a,_0x419112=await getDriveInfo();return console[_0x1768d7(314)](_0x1768d7(331)),console[_0x1768d7(314)](_0x419112),_[_0x1768d7(391)](_0x419112[_0x1768d7(337)])?_0x419112[_0x1768d7(272)]:_0x419112.resource_drive_id}async function getDownloadUrl(_0x5be8a4){var _0x1f5ff6=_0x475d0a,_0xd2176d=await getDriveId(),_0x5be8a4=(console[_0x1f5ff6(314)](_0x1f5ff6(341)),console[_0x1f5ff6(314)](_0x5be8a4),tempIds[_0x1f5ff6(283)](await copy(_0x5be8a4)),{}),_0xd2176d=(_0x5be8a4[_0x1f5ff6(225)]=tempIds[0],_0x5be8a4.drive_id=_0xd2176d,await oauthFunc(_0x1f5ff6(381),_0x5be8a4,!0));return console[_0x1f5ff6(314)]("getDownloadUrl---"),console[_0x1f5ff6(314)](_0xd2176d),await log(_0x1f5ff6(353)+_0xd2176d),JSON[_0x1f5ff6(302)](_0xd2176d)[_0x1f5ff6(318)]}async function getVideoPreviewPlayInfo(_0xcfd481){var _0x160d91=_0x475d0a,_0x253de2=await getDriveId(),_0xcfd481=(tempIds.unshift(await copy(_0xcfd481)),{}),_0x253de2=(_0xcfd481[_0x160d91(225)]=tempIds[0],_0xcfd481[_0x160d91(330)]=_0x253de2,_0xcfd481[_0x160d91(235)]=_0x160d91(257),_0xcfd481.url_expire_sec=_0x160d91(217),await oauthFunc(_0x160d91(365),_0xcfd481,!0));return console[_0x160d91(314)](_0x160d91(278)),console[_0x160d91(314)](_0x253de2),JSON[_0x160d91(302)](_0x253de2)[_0x160d91(364)]}async function playerContent(_0x2b625d){var _0x481d8d=_0x475d0a;try{await deleteTmpFolderAndRecreate()}catch(_0x107a85){console[_0x481d8d(314)](_0x107a85)}try{var _0x2a989c,_0x1080b3=await getDownloadUrl(_0x2b625d[0]),_0x407ee4=await getSubs(_0x2b625d),_0x26b438=[];for(_0x2a989c of _0x407ee4)_0x26b438[_0x481d8d(311)](_0x2a989c[_0x481d8d(318)]);return JSON[_0x481d8d(251)]({parse:0,url:_0x1080b3,header:getHeader(),extra:{subt:_0x26b438},format:_0x481d8d(356),subs:_0x407ee4})}catch(_0x2c79d4){console[_0x481d8d(314)](_0x2c79d4)}}async function playerContentByFlag(_0x1b7f96,_0x5eb4bf){var _0x5df13e=_0x475d0a;try{await deleteTmpFolderAndRecreate()}catch(_0x2b81f7){console[_0x5df13e(314)](_0x2b81f7)}try{var _0x3b844d,_0x2b98d2=await getVideoPreviewPlayInfo(_0x1b7f96[0]),_0xf32d95=getPreviewUrl(_0x2b98d2,_0x5eb4bf),_0xa8e494=await getSubs(_0x1b7f96);for(_0x3b844d of getSubsByPlayInfo(_0x2b98d2))_0xa8e494[_0x5df13e(311)](_0x3b844d);var _0x1b1a81,_0x524736=[];for(_0x1b1a81 of _0xa8e494)_0x524736[_0x5df13e(311)](_0x1b1a81.url);return JSON[_0x5df13e(251)]({parse:0,url:_0xf32d95,header:getHeader(),extra:{subt:_0x524736},format:_0x5df13e(335),subs:_0xa8e494})}catch(_0x4f810b){console[_0x5df13e(314)](_0x4f810b)}}function getPreviewUrl(_0x429883,_0x53b6ac){var _0x58aff7=_0x475d0a;if(!_0x429883[_0x58aff7(324)](_0x58aff7(357)))return"";for(var _0x5bb088=_0x429883[_0x58aff7(357)],_0x15dcd8=0;_0x15dcd8<_0x5bb088.length;++_0x15dcd8){var _0x8b3730=_0x5bb088[_0x15dcd8];if(_0x8b3730[_0x58aff7(243)]==quality[_0x53b6ac])return _0x8b3730[_0x58aff7(318)]}return _0x5bb088[0][_0x58aff7(318)]}function getSubsByPlayInfo(_0x4a91e6){var _0x14f483=_0x475d0a;if(!_0x4a91e6[_0x14f483(324)](_0x14f483(215)))return[];for(var _0x5adb38=_0x4a91e6[_0x14f483(215)],_0x2506c2=[],_0x59872f=0;_0x59872f<_0x5adb38.length;++_0x59872f){var _0x5d089a=_0x5adb38[_0x59872f],_0x54730a=_0x5d089a[_0x14f483(379)],_0x5d089a=_0x5d089a[_0x14f483(318)];_0x2506c2[_0x14f483(311)](Sub.create()[_0x14f483(255)](_0x5d089a)[_0x14f483(387)](_0x54730a).setLang(_0x54730a)[_0x14f483(210)](_0x14f483(204)))}return _0x2506c2}async function copy(_0x1cc37d){var _0x43a1fc=_0x475d0a,_0x1d5900=(await log(_0x43a1fc(321)+user.toString()),_0x43a1fc(254)),_0x3ced75=await getDriveId(),_0x3ced75={fileId:_0x1cc37d,shareId:shareId,driveId:_0x3ced75,tmpFolderFileId:curTmpFolderFileId},_0x1d5900=jinja2(_0x1d5900,{data:_0x3ced75}),_0x3ced75=(await log(_0x43a1fc(250)+_0x1d5900),await auth(_0x43a1fc(289),JSON[_0x43a1fc(302)](_0x1d5900),!0));return await log(_0x43a1fc(355)+_0x3ced75),-1<_0x3ced75[_0x43a1fc(358)](_0x43a1fc(360))?copy(_0x1cc37d):JSON[_0x43a1fc(302)](_0x3ced75)[_0x43a1fc(248)][0][_0x43a1fc(219)][_0x43a1fc(225)]}async function deleteTmpFolderAndRecreate(){var _0x3b1ff7=_0x475d0a,_0x10af5f=await tmpFolderExistsFunc();console[_0x3b1ff7(314)](_0x3b1ff7(388)),console[_0x3b1ff7(314)](_0x10af5f),_0x10af5f&&(await trashFile(_0x10af5f),await recyclebinClear()),curTmpFolderFileId=await createTmpFolder()}async function trashFile(_0x328801){var _0x4ac5d1=_0x475d0a,_0x46cabc=_0x4ac5d1(392),_0x57975f=await getDriveId(),_0x46cabc=jinja2(_0x46cabc,{data:{fileId:_0x328801,driveId:_0x57975f}}),_0x328801=await auth(_0x4ac5d1(327),JSON.parse(_0x46cabc),!0);return console[_0x4ac5d1(314)](_0x4ac5d1(334)),console[_0x4ac5d1(314)](_0x328801),!0}async function recyclebinClear(){var _0x113592=_0x475d0a,_0x128f24=await auth("v2/recyclebin/clear",{drive_id:await getDriveId()},!0);return console[_0x113592(314)](_0x113592(224)),console[_0x113592(314)](_0x128f24),!0}async function createTmpFolder(){var _0x1f7c7e,_0x20a4b5=_0x475d0a;return!!await tmpFolderExistsFunc()||(_0x1f7c7e={check_name_mode:"refuse",drive_id:await getDriveId(),name:tmpFolderName,parent_file_id:_0x20a4b5(385),type:_0x20a4b5(268)},_0x1f7c7e=await oauthFunc(_0x20a4b5(262),_0x1f7c7e,!0),console.debug(_0x20a4b5(267)),console[_0x20a4b5(314)](_0x1f7c7e),_0x1f7c7e=JSON[_0x20a4b5(302)](_0x1f7c7e),!_[_0x20a4b5(391)](_0x1f7c7e[_0x20a4b5(330)])&&_0x1f7c7e.file_id)}async function tmpFolderExistsFunc(){var _0x425df8=_0x475d0a,_0x4f2a1e=await oauthFunc("openFile/list",{drive_id:await getDriveId(),parent_file_id:_0x425df8(385),limit:100,order_by:"updated_at",order_direction:"DESC"},!0),_0x4f2a1e=(console[_0x425df8(314)](_0x425df8(240)),console[_0x425df8(314)](_0x4f2a1e),JSON[_0x425df8(302)](_0x4f2a1e));if(!_[_0x425df8(391)](_0x4f2a1e[_0x425df8(310)]))for(var _0x1fa9cf of _0x4f2a1e.items)if(_0x1fa9cf[_0x425df8(231)]==tmpFolderName)return _0x1fa9cf[_0x425df8(225)];return!1}async function setToken(_0x5d2c52){user.setRefreshToken(_0x5d2c52),await refreshAccessToken(),await refreshOpenToken()}export{initSome,setToken,setShareId,getVod,playerContent,playerContentByFlag};