import{_}from"assets://js/lib/cat.js";let key="bookkan",url="https://api.bookan.com.cn",siteKey="",siteType=0;async function request(reqUrl,agentSp){return(await req(reqUrl,{method:"get"})).content}async function init(cfg){siteKey=cfg.skey,siteType=cfg.stype}async function home(filter){return JSON.stringify({class:[{type_id:"1305",type_name:"少年读物"},{type_id:"1304",type_name:"儿童文学"},{type_id:"1320",type_name:"国学经典"},{type_id:"1306",type_name:"文艺少年"},{type_id:"1309",type_name:"育儿心经"},{type_id:"1310",type_name:"心理哲学"},{type_id:"1307",type_name:"青春励志"},{type_id:"1312",type_name:"历史小说"},{type_id:"1303",type_name:"故事会"},{type_id:"1317",type_name:"音乐戏剧"},{type_id:"1319",type_name:"相声评书"}]})}async function category(tid,pg,filter,extend){0==(pg=pg||1)&&(pg=1);var pg=await request(url+`/voice/book/list?instance_id=25304&page=${pg}&category_id=${tid}&num=24`),tid=JSON.parse(pg).data,books=[];for(const book of tid.list)books.push({book_id:book.id,book_name:book.name,book_pic:book.cover,book_remarks:book.extra.author});return JSON.stringify({page:tid.current_page,pagecount:tid.last_page,limit:24,total:tid.total,list:books})}async function detail(id){var content=await request(url+`/voice/album/units?album_id=${id}&page=1&num=200&order=1`),content=JSON.parse(content).data,id={book_id:id,book_type:"",book_year:"",book_area:"",book_remarks:"",book_actor:"",book_director:"",book_content:""},content=_.map(content.list,function(b){return formatPlayUrl(b.title)+"$"+b.file}).join("#");return id.volumes="书卷",id.urls=content,JSON.stringify({list:[id]})}function formatPlayUrl(name){return name.trim().replace(/<|>|《|》/g,"").replace(/\$|#/g," ").trim()}async function proxy(segments,headers){}async function play(flag,id,flags){return JSON.stringify({parse:0,url:id})}async function search(wd,quick,pg){var wd=await request(`https://es.bookan.com.cn/api/v3/voice/book?instanceId=25304&keyword=${wd}&pageNum=${pg=0==(pg=pg||1)?1:pg}&limitNum=20`),pg=JSON.parse(wd).data,books=[];for(const book of pg.list)books.push({book_id:book.id,book_name:book.name,book_pic:book.cover,book_remarks:book.extra.author});return JSON.stringify({page:pg.current_page,pagecount:pg.last_page,limit:20,total:pg.total,list:books})}function __jsEvalReturn(){return{init:init,home:home,category:category,detail:detail,play:play,search:search}}export{__jsEvalReturn};