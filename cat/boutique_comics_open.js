import{_,Uri,load}from"assets://js/lib/cat.js";let key="boutique",HOST="https://www.qyy158.com",siteKey="",siteType=0;const PC_UA="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36";async function request(reqUrl){reqUrl=await req(reqUrl,{headers:{"User-Agent":PC_UA},buffer:1});return gbk.decode(reqUrl.content)}async function init(cfg){siteKey=cfg.skey,siteType=cfg.stype}async function home(filter){return{class:[{type_id:"all",type_name:"all"}],filters:{all:[{key:"area",name:"地域",init:"",value:[{n:"全部",v:""},{n:"大陆",v:"1"},{n:"日本",v:"2"},{n:"韩国",v:"3"},{n:"欧美",v:"4"}]},{key:"class",name:"类别",init:"",wrap:1,value:[{n:"全部",v:""},{n:"霸总",v:"bazong"},{n:"修真",v:"xiuzhen"},{n:"恋爱",v:"lianai"},{n:"校园",v:"xiaoyuan"},{n:"冒险",v:"maoxian"},{n:"搞笑",v:"gaoxiao"},{n:"生活",v:"shenghuo"},{n:"热血",v:"rexue"},{n:"架空",v:"jiakong"},{n:"后宫",v:"hougong"},{n:"玄幻",v:"xuanhuan"},{n:"悬疑",v:"xuanyi"},{n:"恐怖",v:"kongbu"},{n:"灵异",v:"lingyi"},{n:"动作",v:"dongzuo"},{n:"科幻",v:"kehuan"},{n:"战争",v:"zhanzheng"},{n:"古风",v:"gufeng"},{n:"穿越",v:"chuanyue"},{n:"竞技",v:"jingji"},{n:"励志",v:"lizhi"},{n:"同人",v:"tongren"},{n:"真人",v:"zhenren"},{n:"其他",v:"qita"},{n:"总裁",v:"zongcai"},{n:"异能",v:"yineng"},{n:"韩漫",v:"hanman"},{n:"剧情",v:"juqing"},{n:"大女主",v:"danvzhu"},{n:"都市",v:"dushi"},{n:"格斗",v:"gedou"},{n:"武侠",v:"wuxia"},{n:"日常",v:"richang"},{n:"纯爱",v:"chunai"},{n:"国漫",v:"guoman"},{n:"推理",v:"tuili"},{n:"少年",v:"shaonain"},{n:"奇幻",v:"qihuan"},{n:"短篇",v:"duanpian"},{n:"ABO",v:"abo"},{n:"运动",v:"yundong"},{n:"萌系",v:"mengxi"},{n:"爆笑",v:"baoxiao"},{n:"蔷薇",v:"qiangwei"},{n:"百合",v:"baihe"},{n:"BG",v:"bg"}]},{key:"status",name:"状态",init:"",value:[{n:"全部",v:""},{n:"连载中",v:"1"},{n:"已完结",v:"2"}]}]}}}async function category(tid,pg,filter,extend){0==pg&&(pg=1);var uri=new Uri(HOST+"/sort/"),extend=(extend.class&&uri.addQueryParam("class",extend.class),extend.area&&uri.addQueryParam("area",extend.area),extend.status&&uri.addQueryParam("status",extend.status),1<pg&&uri.addQueryParam("page",pg),uri.toString()),uri=await request(extend);const $=load(uri);extend=$(".cartoon-block-box .cart-item"),uri=_.map(extend,item=>{var item=$(item),$cover=item.find(".cart-cover"),$img=$cover.find("img:first"),$p=item.find(".cart-info p:first"),item=item.find(".new-chapter");return{book_id:$cover.attr("href").replace(/.*\/info\/(.*)\//,"$1"),book_name:$p.text(),book_pic:$img.attr("src"),book_remarks:item.text()}});return{page:pg,pagecount:0<$(".pagelink a.next").length?pg+1:pg,list:uri}}async function detail(id){var html=await request(HOST+`/info/${id}/`);const $=load(html);var html={book_name:$("h1.title").text().trim(),book_director:$(".mt10:contains(作者)").text().substring(3).trim(),book_content:$(".line-clamp-4:contains(简介)").text().substring(3).trim()},list=$(".chapter-list li"),list=_.map(list,item=>{item=$(item).find("a");return item.text()+"$"+(`/info/${id}/`+item.attr("href"))}).join("#");return html.volumes="章节",html.urls=list,{list:[html]}}async function play(flag,id,flags){id=await request(""+HOST+id);const $=load(id);id=$(".chapter-content img");return{content:_.map(id,image=>$(image).attr("data-original"))}}async function search(wd,quick,pg){0==pg&&(pg=1);wd=await request(`${HOST}/search/${encodeURIComponent(wd)}/`);const $=load(wd);wd=$(".cartoon-block-box .cart-item");return{page:pg,pagecount:pg,list:_.map(wd,item=>{var item=$(item),$cover=item.find(".cart-cover"),$img=$cover.find("img:first"),$p=item.find(".cart-info p:first"),item=item.find(".new-chapter");return{book_id:$cover.attr("href").replace(/.*\/info\/(.*)\//,"$1"),book_name:$p.text(),book_pic:$img.attr("src"),book_remarks:item.text()}})}}function __jsEvalReturn(){return{init:init,home:home,category:category,detail:detail,play:play,search:search}}export{__jsEvalReturn};