import{Crypto,load,_}from"assets://js/lib/cat.js";let key="1free",HOST="https://91d.top",url="",siteKey="",siteType=0;const UA="Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13E230 Safari/601.1";async function request(reqUrl,agentSp){return(await req(reqUrl,{method:"get",headers:{"User-Agent":agentSp||UA,Referer:HOST}})).content}async function init(cfg){siteKey=cfg.skey,siteType=cfg.stype;cfg=await request(HOST);url=cfg.match(/<a href="(http.*www.*)" target=.*>/)[1],console.debug("跳转地址 =====>"+url)}async function home(filter){return JSON.stringify({class:[{type_id:1,type_name:"电影"},{type_id:2,type_name:"追剧"},{type_id:3,type_name:"综艺"},{type_id:4,type_name:"动漫"}],filters:{1:[{key:"cateId",name:"类型",value:[{n:"全部",v:"1"},{n:"纪录片",v:"20"},{n:"动作片",v:"6"},{n:"爱情片",v:"8"},{n:"科幻片",v:"9"},{n:"恐怖片",v:"10"},{n:"剧情片",v:"11"},{n:"战争片",v:"12"},{n:"喜剧片",v:"7"}]},{key:"area",name:"地区",value:[{n:"全部",v:""},{n:"中国大陆",v:"大陆"},{n:"中国香港",v:"香港"},{n:"中国台湾",v:"台湾"},{n:"美国",v:"美国"},{n:"法国",v:"法国"},{n:"英国",v:"英国"},{n:"日本",v:"日本"},{n:"韩国",v:"韩国"},{n:"德国",v:"德国"},{n:"泰国",v:"泰国"},{n:"印度",v:"印度"},{n:"意大利",v:"意大利"},{n:"西班牙",v:"西班牙"},{n:"加拿大",v:"加拿大"},{n:"其他",v:"其他"}]},{key:"lang",name:"语言",value:[{n:"全部",v:""},{n:"国语",v:"国语"},{n:"英语",v:"英语"},{n:"粤语",v:"粤语"},{n:"闽南语",v:"闽南语"},{n:"韩语",v:"韩语"},{n:"日语",v:"日语"},{n:"法语",v:"法语"},{n:"德语",v:"德语"},{n:"其它",v:"其它"}]},{key:"year",name:"年份",value:[{n:"全部",v:""},{n:"2023",v:"2023"},{n:"2022",v:"2022"},{n:"2021",v:"2021"},{n:"2020",v:"2020"},{n:"2019",v:"2019"},{n:"2018",v:"2018"},{n:"2017",v:"2017"},{n:"2016",v:"2016"},{n:"2015",v:"2015"},{n:"2014",v:"2014"},{n:"2013",v:"2013"},{n:"2012",v:"2012"},{n:"2011",v:"2011"},{n:"2010",v:"2010"}]},{key:"by",name:"排序",value:[{n:"时间",v:"time"},{n:"人气",v:"hits"},{n:"评分",v:"score"}]}],2:[{key:"cateId",name:"类型",value:[{n:"全部",v:"2"},{n:"国产剧",v:"13"},{n:"欧美剧",v:"14"},{n:"港台剧",v:"15"},{n:"日韩剧",v:"16"},{n:"泰剧",v:"21"}]},{key:"year",name:"年份",value:[{n:"全部",v:""},{n:"2023",v:"2023"},{n:"2022",v:"2022"},{n:"2021",v:"2021"},{n:"2020",v:"2020"},{n:"2019",v:"2019"},{n:"2018",v:"2018"},{n:"2017",v:"2017"},{n:"2016",v:"2016"},{n:"2015",v:"2015"},{n:"2014",v:"2014"},{n:"2013",v:"2013"},{n:"2012",v:"2012"},{n:"2011",v:"2011"},{n:"2010",v:"2010"}]},{key:"by",name:"排序",value:[{n:"时间",v:"time"},{n:"人气",v:"hits"},{n:"评分",v:"score"}]}],3:[{key:"cateId",name:"类型",value:[{n:"全部",v:"3"},{n:"大陆综艺",v:"22"},{n:"港台综艺",v:"25"},{n:"日韩综艺",v:"24"},{n:"欧美综艺",v:"23"}]},{key:"year",name:"年份",value:[{n:"全部",v:""},{n:"2023",v:"2023"},{n:"2022",v:"2022"},{n:"2021",v:"2021"},{n:"2020",v:"2020"},{n:"2019",v:"2019"},{n:"2018",v:"2018"},{n:"2017",v:"2017"},{n:"2016",v:"2016"},{n:"2015",v:"2015"},{n:"2014",v:"2014"},{n:"2013",v:"2013"},{n:"2012",v:"2012"},{n:"2011",v:"2011"},{n:"2010",v:"2010"}]},{key:"by",name:"排序",value:[{n:"时间",v:"time"},{n:"人气",v:"hits"},{n:"评分",v:"score"}]}],4:[{key:"cateId",name:"类型",value:[{n:"全部",v:"4"},{n:"国产动漫",v:"26"},{n:"日韩动漫",v:"28"},{n:"欧美动漫",v:"27"},{n:"港台动漫",v:"29"}]},{key:"year",name:"年份",value:[{n:"全部",v:""},{n:"2023",v:"2023"},{n:"2022",v:"2022"},{n:"2021",v:"2021"},{n:"2020",v:"2020"},{n:"2019",v:"2019"},{n:"2018",v:"2018"},{n:"2017",v:"2017"},{n:"2016",v:"2016"},{n:"2015",v:"2015"},{n:"2014",v:"2014"},{n:"2013",v:"2013"},{n:"2012",v:"2012"},{n:"2011",v:"2011"},{n:"2010",v:"2010"}]},{key:"by",name:"排序",value:[{n:"时间",v:"time"},{n:"人气",v:"hits"},{n:"评分",v:"score"}]}]}})}async function homeVod(){}async function category(tid,pg,filter,extend){pg<=0&&(pg=1);tid=await request(url+"/vodshow/"+(extend.cateId||tid)+"-"+(extend.area||"")+"-"+(extend.by||"time")+"--"+(extend.lang||"")+"----"+pg+"---"+(extend.year||"")+".html");const $=load(tid);extend=$("div.module-items a.module-poster-item"),tid=_.map(extend,item=>{var it=$(item)[0],k=$(item).find("img:first")[0],item=$($(item).find("div.module-item-note")[0]).text().trim();return{vod_id:it.attribs.href.replace(/\/voddetail\/(.*?).html/g,"$1"),vod_name:k.attribs.alt,vod_pic:k.attribs["data-original"],vod_remarks:item||""}}),extend=0<$("div#page > a:contains(下一页)").length?parseInt(pg)+1:parseInt(pg);return JSON.stringify({page:parseInt(pg),pagecount:extend,limit:24,total:24*extend,list:tid})}async function detail(id){var html=await request(url+"/voddetail/"+id+".html");const $=load(html);html={vod_id:id,vod_name:$("h1:first").text().trim(),vod_type:$(".module-info-tag a").text(),vod_actor:$(".module-info-item-content").text(),vod_pic:$(".module-info img:first").attr("data-src"),vod_remarks:$(".stui-content__detail p:nth-child(5)").text()||"",vod_content:$(".module-info-introduction-content p").text().trim()};let playMap={};id=$("div.module-tab-items-box div.module-tab-item span");const playlists=$("div.module-play-list-content");_.each(id,(tab,i)=>{const from=$(tab).text();tab=playlists[i],tab=$(tab).find("a");_.each(tab,it=>{const title=$(it).text();var playUrl=it.attribs.href.replace(/\/vodplay\/(.*?).html/g,"$1");0==title.length&&(title=it.children[0].data.trim()),playMap.hasOwnProperty(from)||(playMap[from]=[]),playMap[from].push(title+"$"+playUrl)})}),html.vod_play_from=_.keys(playMap).join("$$$");id=_.values(playMap),id=_.map(id,urlist=>urlist.join("#"));return html.vod_play_url=id.join("$$$"),JSON.stringify({list:[html]})}async function play(flag,id,flags){id=await request(url+"/vodplay/"+id+".html"),id=load(id),id=JSON.parse(id("script:contains(player_)").html().replace("var player_aaaa=","")).url;return JSON.stringify({parse:0,url:id})}function base64Encode(text){return Crypto.enc.Base64.stringify(Crypto.enc.Utf8.parse(text))}function base64Decode(text){return Crypto.enc.Utf8.stringify(Crypto.enc.Base64.parse(text))}async function search(wd,quick,pg){pg<=0&&(pg=1);wd=await request(url+"/phsch//page/"+pg+"/wd/"+wd+".html");const $=load(wd);var wd=$("div.module-items > div.module-item"),wd=_.map(wd,item=>{var it=$(item).find("a:first")[0],k=$(item).find("img:first")[0],item=$($(item).find("div.module-item-note")[0]).text().trim();return{vod_id:it.attribs.href.replace(/\/v\/(.*?).html/g,"$1"),vod_name:k.attribs.alt,vod_pic:k.attribs["data-original"],vod_remarks:item||""}}),pgCount=0<$("div#page > a:contains(下一页)").length?parseInt(pg)+1:parseInt(pg);return JSON.stringify({page:parseInt(pg),pagecount:pgCount,limit:24,total:24*pgCount,list:wd})}function __jsEvalReturn(){return{init:init,home:home,homeVod:homeVod,category:category,detail:detail,play:play,search:search}}export{__jsEvalReturn};