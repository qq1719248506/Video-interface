import{load,_}from"assets://js/lib/cat.js";let key="🐰兔小贝",HOST="https://www.tuxiaobei.com",siteKey="",siteType=0;const IOS_UA="Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1";async function request(reqUrl,agentSp){return(await req(reqUrl,{method:"get",headers:{"User-Agent":agentSp||IOS_UA}})).content}async function init(cfg){siteKey=cfg.skey,siteType=cfg.stype}async function home(filter){return JSON.stringify({class:_.map([{type_id:"",type_name:"🐰全部"},{type_id:2,type_name:"🐰儿歌"},{type_id:3,type_name:"🐰故事"},{type_id:27,type_name:"🐰公益"},{type_id:9,type_name:"🐰十万个为什么"},{type_id:28,type_name:"🐰安全教育"},{type_id:29,type_name:"🐰动物奇缘"},{type_id:7,type_name:"🐰弟子规"},{type_id:5,type_name:"🐰古诗"},{type_id:6,type_name:"🐰三字经"},{type_id:8,type_name:"🐰千字文"},{type_id:11,type_name:"🐰数学"},{type_id:25,type_name:"🐰英语"},{type_id:24,type_name:"🐰折纸"}],cls=>(cls.land=1,cls.ratio=1.78,cls)),filters:{}})}async function homeVod(){var html=(await request(HOST+"/list/mip-data?typeId=9&page=1&callback=")).match(/\((.*?)\);/)[1],html=JSON.parse(html).data,html=_.map(html.items,it=>({vod_id:it.video_id,vod_name:it.name,vod_pic:it.image,vod_remarks:it.root_category_name+" | "+it.duration_string||""}));return JSON.stringify({list:html})}async function category(tid,pg,filter,extend){(pg<=0||void 0===pg)&&(pg=1);var tid=(await request(HOST+"/list/mip-data?typeId="+tid+"&page="+pg+"&callback=")).match(/\((.*?)\);/)[1],tid=JSON.parse(tid).data,videos=_.map(tid.items,it=>({vod_id:it.video_id,vod_name:it.name,vod_pic:it.image,vod_remarks:it.root_category_name+" | "+it.duration_string||""})),pgCount=30*pg>tid.totalCount?parseInt(pg):parseInt(pg)+1;return JSON.stringify({page:parseInt(pg),pagecount:pgCount,limit:30,total:tid.totalCount,list:videos})}async function detail(id){var vod={vod_id:id,vod_remarks:""},id=["点击播放$"+HOST+"/play/"+id];return vod.vod_play_from="道长在线",vod.vod_play_url=id.join("#"),JSON.stringify({list:[vod]})}async function play(flag,id,flags){id=await request(id),id=load(id)("body mip-search-video[video-src*=http]")[0].attribs["video-src"];return JSON.stringify({parse:0,url:id})}async function search(wd,quick){wd=await request(HOST+"/search/"+wd);const $=load(wd);wd=$("div.list-con > div.items"),wd=_.map(wd,it=>{var a=$(it).find("a:first")[0],img=$(it).find("mip-img:first")[0],tt=$(it).find("p:first")[0],it=$(it).find("p")[1];return{vod_id:a.attribs.href.replace(/.*?\/play\/(.*)/g,"$1"),vod_name:tt.children[0].data,vod_pic:img.attribs.src,vod_remarks:it.children[0].data||""}});return JSON.stringify({list:wd,land:1,ratio:1.78})}function __jsEvalReturn(){return{init:init,home:home,homeVod:homeVod,category:category,detail:detail,play:play,search:search}}export{__jsEvalReturn};